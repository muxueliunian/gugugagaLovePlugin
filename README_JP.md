# gugugagaLovePlugin

> **⚠️ 注意：この日本語版READMEはAIによって生成されたものです。翻訳の正確性は保証されません。正確な情報については、オリジナルの英語版またはオリジナルの中国語版READMEをご参照ください。**

**语言版本 / Language**:[中文](README.md) | [日本語](README_JP.md)


URA (UmamusumeResponseAnalyzer) 用のプラグインで、毎日のニンジン取得量を自動記録し、サークルファンデータをオプションで収集します。

**语言版本 / Language**:[中文](README.md) | [日本語](README_JP.md)

## 機能

- **💎 自動ニンジン統計**: 東八区時間に基づいて毎日取得したニンジン数を統計
- **🎨 カラーリアルタイム表示**: コンソールにカラフルなニンジン統計をリアルタイム表示、定期更新対応
- **📊 ファンデータ収集**: オプション機能、サークルメンバーのファンデータを日付別に収集・保存
- **📁 柔軟な保存**: カスタム出力ディレクトリをサポート、データファイルの独立管理
- **🔧 簡単設定**: URA設定画面から簡単に設定、コード修正不要

## 特徴

### ニンジン統計 (v1.0+)
- ニンジン取得の自動識別・統計（item_type: 90, item_id: 43）
- 東八区日付で `gugugagaMagicCarrot.json` ファイルを生成
- **カラーリアルタイム表示**: 数量に応じて異なる色で表示（0-9灰/10-39緑/40-69赤/70-109青/110+紫）
- **定期更新**: 設定可能な間隔（デフォルト5秒）で常に最新データを表示
- セッション間での累計統計、重複計算を回避

### ファンデータ収集 (v1.1+) 
- **デフォルトでは無効**、手動で有効化して既存機能への影響を回避
- `summary_user_info_array` の重要情報を収集
- 日付別ファイル保存で `yyyymmdd.json` 形式
- 同日データのスマート重複除去、同じ viewer_id は最新レコードを保持
- フィールド順序最適化、タイムスタンプを `yyyymmdd` 形式に簡略化
- 詳細なフィールド説明については [データマッピングドキュメント](src/SummaryUserInfoMapping.md) を参照

## インストール

1. [UmamusumeResponseAnalyzer](https://github.com/UmamusumeResponseAnalyzer/UmamusumeResponseAnalyzer) がインストールされていることを確認
2. 最新の `Plugin.cs` ファイルを URA のプラグインディレクトリにダウンロード
3. URA を再起動またはプラグインを再読み込み

## 出力例

### ニンジン統計ファイル (`gugugagaMagicCarrot.json`)
```json
{
  "20240125": 850,
  "20240126": 1200,
  "20240127": 750
}
```

### ファンデータファイル (`20240128.json`)
```json
{
  "12345678901234567": {
    "name": "テイオー",
    "fan": 1508234,
    "circle_name": "ウマ娘愛好会",
    "ts": "20240128",
    "viewer_id": 12345678901234567,
    "comment": "よろしくお願いします",
    "rank_score": 85230,
    "circle_id": 987654321
  }
}
```

## 設定説明

URA 設定画面で以下のオプションを設定できます：

### ニンジン統計設定
- **ニンジン統計を有効化**: 毎日のニンジン統計を有効にするかどうか（デフォルトは有効）
- **JSON出力ディレクトリ**: ニンジン統計ファイルの保存場所（空白の場合はデフォルト場所を使用）
- **更新間隔**: コンソール表示の更新間隔（秒）、デフォルト5秒、0で定期更新を無効化

### ファン収集設定
- **ファン統計を有効化**: ファンデータ収集機能を開始するかどうか（デフォルトは無効）
- **ファンデータ出力ディレクトリ**: ファンデータファイルの保存場所（空白の場合はデフォルト場所を使用）

### デフォルト出力場所
- 作業ディレクトリ下の `PluginData/gugugagaLovePlugin/` フォルダ
- 相対パスと絶対パスのカスタマイズに対応

## ソースからのビルド

### 前提条件
- .NET 8.0 SDK
- UmamusumeResponseAnalyzer 参照

### ビルド手順
```bash
dotnet build -c Release
```

ビルド完了後、生成されたDLLファイルをURAプラグインディレクトリにコピーしてください。

## クロスプラットフォーム注意事項

- **Windows**: 完全サポート、追加設定不要
- **Linux/macOS**: 対応する .NET 8.0 ランタイムのインストールが必要
- **時間帯処理**: 自動的に "China Standard Time" を使用、中国以外の地域のユーザーは調整が必要な場合があります

## 開発ドキュメント

### プラグイン構造
- `Plugin.cs`: メインプラグインコード、ニンジン統計とファン収集ロジックを含む
- `SummaryUserInfoMapping.md`: 詳細なデータフィールドマッピングドキュメント

### 拡張開発
プラグインはモジュラー設計を採用、簡単に拡張可能：
- ニンジンID設定：`KnownGemKeys` コレクションを修正
- データ形式：JSON シリアライゼーションロジックを調整  
- 時間帯設定：`TzChina` 時間帯設定を修正

## バージョン履歴

### v1.2.0 (2025-10-15)
- 🎨 カラーニンジン数量表示機能を新規追加
- 🎨 数量に応じて異なる色で表示：0-9灰/10-39緑/40-69赤/70-109青/110+紫
- ⏰ 定期更新メカニズムを新規追加、デフォルトで5秒ごとに最新データを自動表示
- ⚙️ 更新間隔設定項目を新規追加、カスタマイズまたは定期更新を無効化可能
- 🔧 コンソール出力形式を最適化：`今日はニンジンをXX個獲得しました 🐧`
- 🔧 出力ロジックを改善、他のプラグイン情報を遮らないように

### v1.1.0 (2025-08-28)
- 🆕 ファンデータ収集機能を新規追加（オプション）
- 🆕 summary_user_info_array データ収集をサポート
- 🆕 日付別ファイル保存、スマート重複除去更新
- 🆕 フィールド順序と時間形式を最適化
- 🆕 詳細なデータマッピングドキュメントを追加
- 🔧 後方互換性を維持、デフォルトでは既存機能に影響なし

### v1.0.3 (2025-08-25)
- 🐛 時間帯変換問題を修正
- 🔧 エラー処理ロジックを最適化

### v1.0.2 (2025-08-20)
- 🔧 ファイルロック機構を改善
- 🔧 JSON フォーマットを最適化

### v1.0.1 (2025-08-15)
- 🐛 パス処理問題を修正
- 🔧 防御的プログラミングを追加

### v1.0.0 (2025-08-10)
- 🎉 初期バージョンリリース
- ✨ 基本ニンジン統計機能

## ライセンス

このプロジェクトは MIT ライセンスを採用しています - 詳細は [LICENSE](LICENSE) ファイルをご覧ください。

## 免責事項

このプラグインは個人学習・研究目的でのみ使用してください。このプラグインの使用により生じたいかなる結果についても、ユーザー自身が責任を負うものとします。関連ゲームの利用規約および現地の法律・規制を遵守することを確実にしてください。

## 関連リンク

- [UmamusumeResponseAnalyzer](https://github.com/UmamusumeResponseAnalyzer/UmamusumeResponseAnalyzer)
- [.NET 8.0 ダウンロード](https://dotnet.microsoft.com/download/dotnet/8.0)

---

🐧 gugugaga!!! 🐧
