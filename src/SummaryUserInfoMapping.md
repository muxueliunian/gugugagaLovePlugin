# summary_user_info_array 字段映射文档

> **📝 注意**: 本文档描述了URA插件采集的 `summary_user_info_array` 数据结构。此映射基于逆向工程分析，字段名称和含义可能随游戏更新而变化。

## 数据来源

`summary_user_info_array` 是从URA游戏响应中提取的JSON数组，包含社团成员的粉丝数据。

## 字段映射表

### 主要字段

| 字段名 | 类型 | 含义 | 示例值 | 备注 |
|--------|------|------|--------|------|
| `viewer_id` | long | 玩家唯一标识符 | `12345678901234567` | 主键，用于去重和索引 |
| `name` | string | 玩家昵称 | `"テイオー" ` | 只包含日语，即游戏内可以输入的内容 |
| `fan` | long | 粉丝数量 | `1508234` | 当前粉丝总数 |
| `comment` | string | 个人简介/签名 | `"よろしくお願いします"` | 同昵称，但是可以比昵称长度更长 |
| `rank_score` | long | 竞技场总评分 | `85230` | 没啥用我偶然发现的 |

别问为什么只有这些，因为gugugaga很懒不想一个一个对

### 社团相关字段 (circle_info)

| 字段路径 | 类型 | 含义 | 示例值 | 备注 |
|----------|------|------|--------|------|
| `circle_info.circle_id` | long | 社团ID | `987654321` | 社团唯一标识 |
| `circle_info.name` | string | 社团名称 | `"ウマ娘愛好会"` | 可能为空(未加入社团) |

## 插件处理逻辑

### 输出格式

插件将上述字段重新组织为以下JSON结构：

```json
{
  "12345678901234567": {
    "name": "テイオー",
    "fan": 1508234,
    "circle_name": "ウマ娘愛好会",
    "ts": "20240128",
    "viewer_id": 12345678901234567,
    "comment": "よろしくお願いします",
    "rank_score": 85230,
    "circle_id": 987654321
  }
}
```

### 字段优先级

为提高可读性，输出字段按以下顺序排列：
1. `name` - 玩家昵称
2. `fan` - 粉丝数
3. `circle_name` - 社团名称  
4. `ts` - 时间戳(简化格式)
5. 其他字段按字母顺序

### 数据处理特性

- **按日期分文件**: 文件名格式为 `yyyymmdd.json`
- **同日去重**: 相同 `viewer_id` 的新数据会覆盖旧数据
- **增量更新**: 新的 `viewer_id` 会追加到现有文件中
- **时间简化**: `ts` 字段使用 `yyyymmdd` 格式而非完整时间戳
- **容错处理**: 缺失字段使用默认值，异常不影响主功能

## 使用场景

此数据可用于：
- 社团成员粉丝数变化追踪
- 排行榜历史分析  
- 玩家活跃度统计
- 社团管理和数据可视化

## 注意事项

1. **隐私保护**: 请妥善保管包含玩家ID的数据文件
2. **性能考虑**: 大量数据时建议定期归档或使用数据库
3. **版本兼容**: 游戏更新可能导致字段结构变化
4. **合规使用**: 仅用于个人分析，不可用于商业用途